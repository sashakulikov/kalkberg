<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" href="style.css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta http-equiv="Content-Language" content="de, fr, it, en">
  <meta name="author" content="">
  <link rel="icon" type="image/png" href="favicon.png">
  <title>Nocturnal Serenade</title>
</head>

<body>

 <video autoplay loop muted playsinline>
  <source src="nocturnal_frogs.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>

  <audio id="audioPlayer" controls>
    <source src="https://dl.dropbox.com/scl/fi/5trcqms4uyur5nr817psp/nocturnalserenade.mp3?rlkey=5wry4wtw9q2gf08oru3cjyy7r&st=bbk8ivpi" type="audio/mp3">
    Your browser does not support the audio element.
  </audio>

  <div class='header'>
    Nocturnal Serenade
    <br><a target="_blank" rel="noopener noreferrer" href="https://maps.app.goo.gl/eaZ2kZXRosPMD5mSA">Kalkberg, 21339 Lüneburg, DE</a>
  </div>

  <div class='lbutton playButton' onclick="playAudio()"> <!-- Add 'playButton' class to the play button and call the playAudio function when clicked -->
    Play
  </div>

  <div class='rbutton' onclick="toggleInfo()">
    Info
  </div>

  <div class='colophon'>
    Experience the enchantment of the Lüneburg’s Kalkberg from April till June… A pit with a pond which once was a rock. Here we• the croaking frogs• greet wonderers with our nocturnes… Like in fairytales• we transform the natural world into the magical realm… Amidst the ancient limestone formations• lush greenery• and bouquet of the lilac• we enamour you with our vibrations… As night descends• step into the the infinitely channeled soundscape• where our chorus fills the air with a sonic adventure…
  </div>



  <div class='footer'>
    <div class='menu'>
      <span class="button playButton" onclick="playAudio()">Play</span>&ensp;
      <span class="button" onclick="toggleInfo()">Info</span>
    </div>
    <span class="activity">Now croaking</span> <br>
    <span class="date-time">Thu, May 2, 23:03</span>, <span class="temp">25°C</span><!-- Add this line for temperature display -->
  </div>

  <script>
    let colophonVisible = false;

    function toggleInfo() {
      var colophon = document.querySelector('.colophon');

      if (colophon.style.display === 'none' || colophon.style.display === '') {
        colophon.style.display = 'block';
      } else {
        colophon.style.display = 'none';
      }
    }



    function updateTime() {
         var now = new Date();
         var hour = now.getHours();
         var body = document.querySelector('body');

         // Calculate the green value based on the time of day
         var brightestGreen = 120; // Brightest green value (10:00)
         var darkestGreen = 20; // Darkest green value (22:00)
         var currentGreen = brightestGreen - ((brightestGreen - darkestGreen) * ((hour - 10) / 12)); // Adjust the hour range (10:00 to 22:00)
         var backgroundColor = 'rgb(0, ' + Math.round(currentGreen) + ', 0)';

         body.style.backgroundColor = backgroundColor;

         // Update text content based on the time of day
         var activityElement = document.querySelector('.footer .activity');
         if (hour >= 6 && hour < 19) {
           activityElement.textContent = 'No croaking';
         } else {
           activityElement.textContent = 'Now croaking';
         }

         // Update date and time in the footer
         var options = {
           timeZone: 'Europe/Berlin',
           weekday: 'short',
           month: 'short',
           day: 'numeric',
           hour: 'numeric',
           minute: 'numeric',
           hour12: false,
           day: 'numeric',
           formatMatcher: 'best fit'
         };
         var dateString = new Intl.DateTimeFormat('en-DE', options).format(now); // Format the date and time for Germany's timezone
         var dateTimeElement = document.querySelector('.footer .date-time');
         if (dateTimeElement) {
           dateTimeElement.textContent = dateString;
         } else {
           console.error('Date/time element not found');
         }
       }


    async function updateTemperature() {
      const url = 'https://api.brightsky.dev/current_weather?lat=53.2484&lon=10.3969';
      const options = {
        method: 'GET',
        headers: {
          Accept: 'application/json'
        }
      };

      try {
        const response = await fetch(url, options);
        const data = await response.json();
        console.log(data);

        const temperature = Math.round(data.weather.temperature);
        console.log('Temperature:', temperature);

        const tempElement = document.querySelector('.footer .temp');

        if (tempElement) {
          tempElement.textContent = temperature + '°C';
        } else {
          console.error('Temp element not found');
        }
      } catch (error) {
        console.error(error);
      }
    }

    // Call updateTime function initially and every second to continuously update the date and time
    updateTime();
    setInterval(updateTime, 1000);

    // Call updateTemperature function initially and then every 5 minutes to fetch and display the temperature
    updateTemperature();
    setInterval(updateTemperature, 5 * 60 * 1000); // Update temperature every 5 minutes

    function playAudio() {
          var audio = document.getElementById('audioPlayer');
          if (audio.paused) {
            audio.play();
            document.querySelectorAll('.playButton').forEach(button => button.textContent = 'Stop'); // Change button text to 'Stop'
          } else {
            audio.pause();
            document.querySelectorAll('.playButton').forEach(button => button.textContent = 'Play'); // Change button text to 'Play'
          }
        }

  </script>

</body>

</html>
